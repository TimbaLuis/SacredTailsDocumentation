<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Bar | Example Unity documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Bar | Example Unity documentation ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../LogoSacred.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<ul>
<li><a href="#bar">Bar</a><ul>
<li><a href="#drinking-and-eating-system">Drinking and eating system</a></li>
<li><a href="#tournament-system">Tournament system</a></li>
</ul>
</li>
</ul>
<h1 id="bar">Bar</h1>
<p>The bar is the lastest update on the game. It functions as a reunion site to drink/eat, watch shinsei fights and check tournaments. Let&#39;s see those functionalities in more details</p>
<h2 id="drinking-and-eating-system">Drinking and eating system</h2>
<p>This system is basically a specific NPC interaction for that reason the charge script is called Cooker.cs, this script store references to the NPC animator Cooker and other props like a ber or eat plate, when character interact start to play a coroutine that play secuencially animations, show and hide objects for make the illusión of interaction, using a callback of dialogue turn on a script that show the animation pending of response of character in this case give a beer of serving a plate of food.</p>
<p> <img src="../resources/Kombucha.png" alt="Kombucha"></p>
<p> For decoration the bar also have a Sit system when you can see other players sitdown or you can sitdown in the chairs of bar, this system works using nearness, the first character that touch the sit can use the other player will be ignored, for reason of delay of server you can see different things when you see from one client or other, the chair always align their forward direction to the character.</p>
<p> <img src="../resources/Sit.png" alt="Sit"></p>
<h2 id="tournament-system">Tournament system</h2>
<p>The tournament system is a complex system that has to handle multiple cases and states of the users in order to garantee a correct flow of the tournament. We have to check the state of the whole tournament and the state of each bracket. The state of the players if they are ready or not to fight. The disconnection of players. A lot of variables to take in consideration. Here is a general flow of the system: </p>
<p><img src="../resources/TournamentFlow.png" alt="TournamentSystem"></p>
<p>We start by requesting the tournament list in the bar. We request and display them with the <a href="">SearchAndShow.cs</a> filtering the ones that hasn&#39;t finished yet and then let the user decide one of them. Once the user decides we execute the <a href="">JoinTournament()</a> in the <a href="">TournamentSlot.cs</a>. If the joining was a success, we proceed to hide all the things that should be hidden in a tournament such as searching for matches or changing the shinseis position in our vault. </p>
<p>Then we start the timer to wait for the tournament to initiate in the <a href="">ShowTimerInitTournament()</a> of the <a href="">TournamentReadyController.cs</a>. This method checks if the tournament has started already, if it doesn&#39;t then it proceeds to show the countdown to initiate the tournament. If it has, proceeds to show the ready button for the player to start his current match in the tournament with the <a href="">StartReadyButton()</a>. This method sets the timer to get ready for the match before a disqualification. If the players clicks on the ready button then the <a href="">MarkAsReady()</a> method start to execute every X seconds. This method will send a petiton to the azure server to check if the other player also accepted the match. In this method we also check if the player won by default and, if so, then we proceed to show him the time left for the next round to begin with the <a href="">ShowPendingTimeAfterMatch()</a> . Otherwise, if the two players get ready for the match, the match starts.</p>
<p>Once they finished the match we proceed to check the tournament state every 3 seconds with the method <a href="">CheckTournamentState()</a> of <a href="">CheckTournamentState.cs</a>. In this method we send a petion to the server and in it&#39;s response we check a variaty of states, ranging from winner of tournament, second place, loser of match and finally winner of match. It&#39;s this last case, were we show the player the <a href="">ShowPendingTimeAfterMatch()</a> method from before, so that he can see the time to end the match. But we keep asking the server if the round has ended before time(if all players have already played their matches). If so then we show again the [StartReadyButton()] and the cycle begins again until there is a winner in the tournament.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/ifalvarez/SacredTails/blob/Dev/Documentation/manual/10.bar.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Example Unity documentation
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
